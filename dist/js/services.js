angular.module("registry.services",[]).factory("API",["$http","$window","$rootScope",function(e,t,r){return{signin:function(e){t.location.href="/auth/github?redirect="+e},logout:function(){return e.get("/auth/logout",{method:"GET"})},redirectErr:function(){t.location.href="/404"},saveFile:function(t){return e.post("/api/v1/create",{method:"POST",params:{form:t}})},getRegistry:function(){return http.get("/registry")},favFile:function(t){return e.get("/api/v1/files/fav/"+t,{method:"GET"})},unFavFile:function(t){return e.get("/api/v1/files/unfav/"+t,{method:"GET"})},checkFav:function(){return e.get("/api/v1/user/fav",{method:"GET"})},getFiles:function(t){return e.get("/api/v1/files/",{method:"GET",params:{page:t,limit:5}})},getFileWithId:function(t){return e.get("/api/v1/files/"+t,{method:"GET",params:{id:t}})},getUserFiles:function(){return e.get("/api/v1/user/files",{method:"GET"})},getUserFavorites:function(){return e.get("/api/v1/user/favorites",{method:"GET"})},deleteStackfile:function(t){return e["delete"]("/api/v1/files/"+t,{method:"DELETE",params:{id:t}})},searchFile:function(t){return e.get("/api/v1/search",{method:"GET",params:{term:t}})},getUser:function(){return e.get("/api/v1/user",{method:"GET"})},getUserRepos:function(t){return e.get("/api/v1/user/repos",{method:"GET",params:{name:t}})},getUserOrgs:function(){return e.get("/api/v1/user/orgs",{method:"GET"})},getRepoBranches:function(t,r){return e.get("/api/v1/user/repos/branches",{method:"GET",params:{orgname:t,repo:r}})},getUserReposInfo:function(t,r,n,i){return e.post("/api/v1/user/repos/new",{method:"GET",params:{orgname:t,repo:r,branch:n,path:i}})},getYAMLFile:function(t,r,n){return e.post("/api/v1/user/repos/file",{method:"POST",params:{id:t,repo:r,path:n}})}}}]).factory("Loader",["API",function(e){var t=function(){this.items=[],this.busy=!1,this.after=1};return t.prototype.nextPage=function(){if(!this.busy){this.busy=!0;var t=this;return e.getFiles(this.after).success(function(e,r,n,i){var o=e;if(0===e.length)return void(t.busy=!0);for(var s=0;s<o.length;s++)t.items.push(o[s]);t.after=t.after+1,t.busy=!1}).error(function(e,r,n,i){t.busy=!1})}},t}]);